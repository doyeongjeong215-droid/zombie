<!doctype html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>í•­í•´ ì¢€ë¹„ ìƒì¡´ íƒ€ì´ì¿¤ - MVP</title>
    <style>
      :root {
        --bg: #0e1726;
        --panel: #14213d;
        --panel-2: #1f355a;
        --accent: #fca311;
        --danger: #ef476f;
        --ok: #06d6a0;
        --text: #edf2f4;
      }
      * { box-sizing: border-box; }
      body {
        margin: 0;
        font-family: "Pretendard", "Noto Sans KR", system-ui, sans-serif;
        background: radial-gradient(circle at top, #1b2f52 0%, var(--bg) 55%);
        color: var(--text);
      }
      .app {
        max-width: 1080px;
        margin: 0 auto;
        padding: 20px;
        display: grid;
        gap: 16px;
        grid-template-columns: 2fr 1fr;
      }
      .card {
        background: linear-gradient(180deg, var(--panel), var(--panel-2));
        border: 1px solid rgba(255, 255, 255, 0.12);
        border-radius: 14px;
        padding: 16px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.25);
      }
      h1, h2, h3 { margin: 0 0 10px; }
      .sub { opacity: 0.85; margin-bottom: 8px; }
      .stats {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 10px;
      }
      .stat {
        background: rgba(255, 255, 255, 0.07);
        border-radius: 10px;
        padding: 10px;
      }
      .label { font-size: 12px; opacity: 0.8; }
      .value { font-size: 22px; font-weight: 700; }
      .meter {
        height: 8px;
        border-radius: 999px;
        background: rgba(255, 255, 255, 0.15);
        margin-top: 6px;
        overflow: hidden;
      }
      .meter > span {
        display: block;
        height: 100%;
        background: linear-gradient(90deg, var(--accent), #ffd166);
      }
      .actions {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 10px;
        margin-top: 14px;
      }
      button {
        border: 0;
        border-radius: 10px;
        padding: 10px;
        color: #0e1726;
        background: var(--accent);
        font-weight: 700;
        cursor: pointer;
      }
      button.secondary { background: #8ecae6; }
      button.danger { background: #ff758f; }
      button:disabled { opacity: 0.5; cursor: not-allowed; }
      .log {
        max-height: 320px;
        overflow: auto;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        padding: 10px;
        font-size: 14px;
      }
      .log p { margin: 0 0 8px; line-height: 1.4; }
      .tag {
        display: inline-block;
        font-size: 12px;
        padding: 3px 8px;
        border-radius: 999px;
        margin-right: 6px;
      }
      .act { background: rgba(252, 163, 17, 0.25); }
      .warn { background: rgba(239, 71, 111, 0.3); }
      .ok { background: rgba(6, 214, 160, 0.3); }
      .status-line {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin-bottom: 12px;
      }
      .status-pill {
        background: rgba(255, 255, 255, 0.1);
        border-radius: 999px;
        padding: 4px 10px;
        font-size: 12px;
      }
      .timeline {
        margin-top: 14px;
        font-size: 13px;
        opacity: 0.88;
      }
      @media (max-width: 900px) {
        .app { grid-template-columns: 1fr; }
      }
    </style>
  </head>
  <body>
    <div class="app">
      <section class="card">
        <h1>ğŸ§­ ìƒì¡´ í•­í•´ íƒ€ì´ì¿¤: Zombie Tide</h1>
        <p class="sub">ë‚®ì—ëŠ” ìƒì¡´ê³¼ ì œì‘, ë°¤ì—ëŠ” ì¢€ë¹„ ì›¨ì´ë¸Œ. ë°°ë¥¼ ìˆ˜ë¦¬í•˜ê³  ì™¸í•´ íƒí—˜ì„ ì‹œì‘í•˜ì„¸ìš”.</p>

        <div class="status-line">
          <span class="status-pill" id="dayAct">Day 1 Â· Act 1</span>
          <span class="status-pill" id="phase">ì£¼ê°„ ë‹¨ê³„</span>
          <span class="status-pill" id="shipState">ë‚œíŒŒì„  ë¯¸ë°œê²¬</span>
          <span class="status-pill" id="baseThreat">ê¸°ì§€ ìœ„í˜‘: ë‚®ìŒ</span>
        </div>

        <div class="stats" id="stats"></div>

        <div class="actions">
          <button id="farmBtn">ğŸŒ¾ ë†ì‚¬</button>
          <button id="craftBtn">ğŸ”¨ ì œì‘</button>
          <button id="restBtn" class="secondary">ğŸ˜´ íœ´ì‹</button>
          <button id="defendBtn" class="secondary">ğŸ›¡ï¸ ë°©ì–´ ì¤€ë¹„</button>
          <button id="exploreBtn">ğŸ§­ íƒí—˜</button>
          <button id="sailBtn" class="danger">â›µ í•­í•´ ì¶œë°œ</button>
          <button id="nextBtn" style="grid-column: 1 / -1">â­ï¸ ë‹¤ìŒ ë‚  ì§„í–‰</button>
        </div>

        <p class="timeline" id="timeline">ëª©í‘œ: Day 15 ì´ì „ ë‚œíŒŒì„  ë°œê²¬ â†’ Day 30 ì´ì „ ë°° ìˆ˜ë¦¬ ì™„ë£Œ.</p>
      </section>

      <section class="card">
        <h2>ğŸ“œ ì‚¬ê±´ ë¡œê·¸</h2>
        <div class="log" id="log"></div>
      </section>
    </div>

    <script>
      const state = {
        day: 1,
        food: 45,
        materials: 30,
        stamina: 60,
        memory: 50,
        fear: 20,
        defense: 15,
        infection: 0,
        livestock: 6,
        farm: 100,
        residents: 9,
        shipFound: false,
        shipProgress: 0,
        sailing: false,
        sailingFuel: 0,
        externalLoot: 0,
        lastAttack: 0,
      };

      const statConfig = [
        ["ğŸ”‹ ê¸°ë ¥", "stamina", 100],
        ["ğŸš ì‹ëŸ‰", "food", 200],
        ["ğŸ”¨ ìì¬", "materials", 200],
        ["ğŸ§  ê¸°ì–µë ¥", "memory", 100],
        ["ğŸ˜± ê³µí¬", "fear", 100],
        ["â˜£ï¸ ê°ì—¼ë„", "infection", 100],
        ["ğŸ„ ê°€ì¶•", "livestock", 20],
        ["ğŸšï¸ ë†ì¥ ë‚´êµ¬ë„", "farm", 100],
      ];

      const statsEl = document.getElementById("stats");
      const logEl = document.getElementById("log");

      function clamp(v, min, max) { return Math.max(min, Math.min(max, v)); }
      function rnd(min, max) { return Math.floor(Math.random() * (max - min + 1)) + min; }

      function currentAct() {
        if (state.day <= 15) return 1;
        if (state.day <= 30) return 2;
        return 3;
      }

      function pushLog(text, type = "act") {
        const p = document.createElement("p");
        p.innerHTML = `<span class="tag ${type}">${type.toUpperCase()}</span>${text}`;
        logEl.prepend(p);
      }

      function render() {
        document.getElementById("dayAct").textContent = `Day ${state.day} Â· Act ${currentAct()}`;
        document.getElementById("phase").textContent = state.sailing ? "ì™¸í•´ íƒí—˜ ì¤‘" : "ì„¬ ìš´ì˜ ë‹¨ê³„";
        document.getElementById("shipState").textContent = state.shipFound
          ? `ë°° ìˆ˜ë¦¬ ${state.shipProgress}%`
          : "ë‚œíŒŒì„  ë¯¸ë°œê²¬";

        const threat = state.fear + state.infection + Math.max(0, 50 - state.defense);
        const threatLabel = threat > 130 ? "ë§¤ìš° ë†’ìŒ" : threat > 90 ? "ë†’ìŒ" : threat > 60 ? "ì¤‘ê°„" : "ë‚®ìŒ";
        document.getElementById("baseThreat").textContent = `ê¸°ì§€ ìœ„í˜‘: ${threatLabel}`;

        statsEl.innerHTML = "";
        for (const [label, key, max] of statConfig) {
          const value = state[key];
          const ratio = clamp((value / max) * 100, 0, 100);
          const stat = document.createElement("div");
          stat.className = "stat";
          stat.innerHTML = `
            <div class="label">${label}</div>
            <div class="value">${Math.round(value)}</div>
            <div class="meter"><span style="width:${ratio}%"></span></div>
          `;
          statsEl.appendChild(stat);
        }

        document.getElementById("timeline").textContent =
          currentAct() === 1
            ? "Act1 ëª©í‘œ: ë‚œíŒŒì„  ë°œê²¬ + ìƒì¡´ê¸°ë°˜ êµ¬ì¶•"
            : currentAct() === 2
            ? "Act2 ëª©í‘œ: ê¸°ìˆ  í•´ê¸ˆê³¼ ë°° ìˆ˜ë¦¬ ì™„ë£Œ"
            : "Act3 ëª©í‘œ: ì™¸í•´ íƒí—˜/ë¬´ì—­ê³¼ ì„¬ ë°©ì–´ì˜ ê· í˜•";

        document.getElementById("sailBtn").disabled = !state.shipFound || state.shipProgress < 100 || state.sailing;
      }

      function consumeDaily() {
        state.food -= 6 + Math.floor(state.residents / 3);
        state.stamina -= 8;
        state.memory -= state.sailing ? 7 : 2;
        if (state.food < 10) state.fear += 8;
        if (state.memory < 20) state.fear += 4;
        if (state.food <= 0) {
          state.infection += 6;
          state.food = 0;
          pushLog("ì‹ëŸ‰ ê³ ê°ˆë¡œ ì£¼ë¯¼ì˜ ë©´ì—­ë ¥ì´ ê¸‰ê²©íˆ ë–¨ì–´ì¡ŒìŠµë‹ˆë‹¤.", "warn");
        }
      }

      function zombieWave() {
        const power = rnd(20, 45) + state.day + Math.floor(state.infection / 2);
        const guard = state.defense + rnd(0, 30);
        if (guard >= power) {
          state.materials += rnd(2, 8);
          state.fear = clamp(state.fear - 3, 0, 100);
          pushLog("ì•¼ê°„ ì¢€ë¹„ ì›¨ì´ë¸Œë¥¼ ë§‰ì•„ë‚´ë©° ì „ë¦¬í’ˆì„ í™•ë³´í–ˆìŠµë‹ˆë‹¤.", "ok");
          return;
        }
        const damage = power - guard;
        state.farm = clamp(state.farm - damage, 0, 100);
        state.livestock = clamp(state.livestock - Math.ceil(damage / 18), 0, 20);
        state.infection = clamp(state.infection + Math.ceil(damage / 10), 0, 100);
        state.fear = clamp(state.fear + Math.ceil(damage / 8), 0, 100);
        state.lastAttack = state.day;
        pushLog(`ê¸°ì§€ ì¹¨ì… ë°œìƒ! ë†ì¥ -${damage}% í”¼í•´, ê°€ì¶• ì¼ë¶€ ê°ì—¼.`, "warn");
      }

      function offshoreAttackTick() {
        if (!state.sailing) return;
        if (Math.random() < 0.55) {
          const damage = rnd(8, 20);
          state.farm = clamp(state.farm - damage, 0, 100);
          state.infection = clamp(state.infection + rnd(2, 6), 0, 100);
          pushLog(`í•­í•´ ì¤‘ ê²½ê³  ìˆ˜ì‹ : ì„¬ì´ ê³µê²©ë°›ì•„ ë†ì¥ ${damage}% ì†ìƒ! ë³µê·€ë¥¼ ê³ ë ¤í•˜ì„¸ìš”.`, "warn");
        } else {
          const loot = rnd(8, 18);
          state.externalLoot += loot;
          state.materials += loot;
          state.memory = clamp(state.memory + 3, 0, 100);
          pushLog(`ì™¸í•´ íƒí—˜ ì„±ê³¼: í¬ê·€ ìì¬ ${loot} í™•ë³´.`, "ok");
        }
      }

      function checkStoryEvents() {
        if (!state.shipFound && state.day >= 8 && state.memory >= 35) {
          state.shipFound = true;
          pushLog("ì ˆë²½ ì•„ë˜ ë‚œíŒŒì„ ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤. ë°”ê¹¥ì„¸ìƒìœ¼ë¡œ í–¥í•  í¬ë§ì´ ìƒê²¼ìŠµë‹ˆë‹¤.", "act");
        }
        if (state.shipFound && state.shipProgress >= 40 && state.day > 15 && state.day <= 30) {
          pushLog("ë‚œíŒŒì„  í•´ì²´ ê¸°ìˆ ë¡œ ì „ê¸° ì„¤ë¹„ì™€ í™”ê¸° ì œì‘ì´ í•´ê¸ˆë˜ì—ˆìŠµë‹ˆë‹¤.", "act");
        }
        if (state.livestock > 0 && state.infection > 35 && Math.random() < 0.35) {
          state.livestock = clamp(state.livestock - 1, 0, 20);
          pushLog("ê°€ì¶• ì¢€ë¹„í™” ë°œìƒ! ì‚¬ìœ¡ì¥ ë°©ì—­ì´ í•„ìš”í•©ë‹ˆë‹¤.", "warn");
        }
      }

      function nextDay() {
        state.day += 1;
        consumeDaily();
        zombieWave();
        offshoreAttackTick();
        if (state.sailing) {
          state.sailingFuel -= 1;
          if (state.sailingFuel <= 0) {
            state.sailing = false;
            pushLog("ì›ì • ì—°ë£Œê°€ ì†Œì§„ë˜ì–´ ì„¬ìœ¼ë¡œ ê·€í™˜í–ˆìŠµë‹ˆë‹¤.", "act");
          }
        }
        state.fear = clamp(state.fear - 1, 0, 100);
        state.stamina = clamp(state.stamina, 0, 100);
        state.memory = clamp(state.memory, 0, 100);
        checkGameOver();
        checkStoryEvents();
        render();
      }

      function checkGameOver() {
        if (state.farm <= 0 || state.infection >= 100 || state.residents <= 0) {
          pushLog("ì½œë¡œë‹ˆê°€ ë¶•ê´´í–ˆìŠµë‹ˆë‹¤. ìƒˆ ë£¨í”„ë¥¼ ì‹œì‘í•˜ì„¸ìš” (ìƒˆë¡œê³ ì¹¨).", "warn");
          Array.from(document.querySelectorAll("button")).forEach((b) => (b.disabled = true));
        }
      }

      document.getElementById("farmBtn").onclick = () => {
        const gain = rnd(8, 16) + Math.floor(state.farm / 20);
        state.food += gain;
        state.stamina -= 10;
        pushLog(`ë†ì‚¬ë¥¼ í†µí•´ ì‹ëŸ‰ +${gain}.`, "ok");
        render();
      };
      document.getElementById("craftBtn").onclick = () => {
        if (state.materials < 6) return pushLog("ìì¬ê°€ ë¶€ì¡±í•´ ì œì‘ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.", "warn");
        state.materials -= 6;
        state.defense += rnd(4, 9);
        state.shipProgress += state.shipFound ? rnd(5, 12) : 0;
        state.shipProgress = clamp(state.shipProgress, 0, 100);
        state.stamina -= 8;
        pushLog("ë°©ì–´ì‹œì„¤ ê°•í™” ë° ì„ ì²´ ìˆ˜ë¦¬ ì§„í–‰.", "ok");
        render();
      };
      document.getElementById("restBtn").onclick = () => {
        state.stamina = clamp(state.stamina + 18, 0, 100);
        state.memory = clamp(state.memory + 6, 0, 100);
        state.food -= 5;
        pushLog("íœ´ì‹ìœ¼ë¡œ ê¸°ë ¥ê³¼ ê¸°ì–µë ¥ì´ íšŒë³µë˜ì—ˆìŠµë‹ˆë‹¤.", "act");
        render();
      };
      document.getElementById("defendBtn").onclick = () => {
        state.materials -= 4;
        if (state.materials < 0) {
          state.materials = 0;
          return pushLog("ìì¬ ë¶€ì¡±ìœ¼ë¡œ í•¨ì • ë°°ì¹˜ ì‹¤íŒ¨.", "warn");
        }
        state.defense += 10;
        state.fear = clamp(state.fear - 5, 0, 100);
        pushLog("ì£¼ë¯¼ì„ ë°°ì¹˜í•´ ì•¼ê°„ ìë™ ë°©ì–´ë¥¼ ê°•í™”í–ˆìŠµë‹ˆë‹¤.", "ok");
        render();
      };
      document.getElementById("exploreBtn").onclick = () => {
        state.stamina -= 12;
        state.memory += rnd(3, 8);
        state.materials += rnd(4, 10);
        if (!state.shipFound && Math.random() < 0.35) {
          state.shipFound = true;
          pushLog("í•´ì•ˆ íƒìƒ‰ ì¤‘ ë‚œíŒŒì„ ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤!", "act");
        } else {
          pushLog("íƒí—˜ìœ¼ë¡œ ìì¬ì™€ ë‹¨ì„œë¥¼ í™•ë³´í–ˆìŠµë‹ˆë‹¤.", "act");
        }
        render();
      };
      document.getElementById("sailBtn").onclick = () => {
        state.sailing = true;
        state.sailingFuel = 3;
        state.food -= 10;
        state.stamina -= 15;
        pushLog("ë›ì„ ì˜¬ë¦¬ê³  ì™¸í•´ íƒí—˜ì„ ì‹œì‘í–ˆìŠµë‹ˆë‹¤. ê¸°ì§€ ìë™ë°©ì–´ë¥¼ ë¯¿ì–´ì•¼ í•©ë‹ˆë‹¤.", "act");
        render();
      };
      document.getElementById("nextBtn").onclick = nextDay;

      pushLog("ìƒì¡´ ë£¨í”„ ì‹œì‘: ë‚®ì— ì¤€ë¹„í•˜ê³  ë°¤ì— ë²„í…¨ë¼.", "act");
      render();
    </script>
  </body>
</html>
